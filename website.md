# tapx.io ‚Äî –°–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è —Å–∞–π—Ç–∞ –∏ API

**–î–æ–∫—É–º–µ–Ω—Ç:** –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞, API-–∫–æ–Ω—Ç—Ä–∞–∫—Ç, –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞, –º–æ–Ω–µ—Ç–∏–∑–∞—Ü–∏—è
**–°–æ–≤–º–µ—Å—Ç–∏–º —Å:** —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ TapX v0.2.0 (`plan-upload-to-tapx.md`)
**–î–∞—Ç–∞:** 2026-02-23

---

## –ö–æ–Ω—Ü–µ–ø—Ü–∏—è

tapx.io ‚Äî —ç—Ç–æ –ø—É–±–ª–∏—á–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –∏ —Å–∫–∞—á–∏–≤–∞–Ω–∏—è —Å–æ–±—Ä–∞–Ω–Ω—ã—Ö –ø–∞–∑–ª–æ–≤ –∏–∑ X.com. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç—Å—è –∏ –Ω–µ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç –Ω–∏—á–µ–≥–æ ‚Äî —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ –∑–∞–≥—Ä—É–∂–∞–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ, –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –≥–æ—Ç–æ–≤–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞.

**–û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Å–∞–π—Ç–∞:**
- –ü—Ä–∏–Ω—è—Ç—å —Å–æ–±—Ä–∞–Ω–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –æ—Ç —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è
- –ü–æ–∫–∞–∑–∞—Ç—å –µ–≥–æ –Ω–∞ –∫—Ä–∞—Å–∏–≤–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ —Å –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–º–∏ —Ç–≤–∏—Ç–∞
- –î–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Å–∫–∞—á–∞—Ç—å
- –ú–æ–Ω–µ—Ç–∏–∑–∏—Ä–æ–≤–∞—Ç—å: —Ä–µ–∫–ª–∞–º–∞ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞
- –°–ª—É–∂–∏—Ç—å —Ç–æ—á–∫–æ–π —Ä–æ—Å—Ç–∞: –ª—é–±–æ–π, –∫—Ç–æ –ø–æ–ª—É—á–∏–ª —Å—Å—ã–ª–∫—É –Ω–∞ tapx.io/d/..., –≤–∏–¥–∏—Ç "Get TapX extension"

---

## –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –ø—É—Ç—å (User Journey)

```
[X.com ‚Äî –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç –ø–∞–∑–ª]
         ‚Üì
[–ö–ª–∏–∫–∞–µ—Ç –∫–Ω–æ–ø–∫—É –≤ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–∏]
         ‚Üì
[–†–∞—Å—à–∏—Ä–µ–Ω–∏–µ: Canvas-—Å–∫–ª–µ–π–∫–∞ ‚Üí POST /api/upload]
         ‚Üì
[–°–∞–π—Ç: —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ñ–∞–π–ª + –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ ‚Üí –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç URL]
         ‚Üì
[–†–∞—Å—à–∏—Ä–µ–Ω–∏–µ: –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç tapx.io/d/{id} –≤ –Ω–æ–≤–æ–π –≤–∫–ª–∞–¥–∫–µ]
         ‚Üì
[–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞ tapx.io: –≤–∏–¥–∏—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ + —Ç–≤–∏—Ç]
         ‚Üì
[–ö–ª–∏–∫–∞–µ—Ç Download ‚Üí —Å–∫–∞—á–∏–≤–∞–µ—Ç —Ñ–∞–π–ª]
         ‚Üì (–ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ)
[–í–∏–¥–∏—Ç —Ä–µ–∫–ª–∞–º—É + —Å—Å—ã–ª–∫—É "Install TapX"]
```

**–í—Ç–æ—Ä–∏—á–Ω—ã–π –ø—É—Ç—å (—à–µ—Ä–∏–Ω–≥):**
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–µ–ª–∏—Ç—Å—è —Å—Å—ã–ª–∫–æ–π `tapx.io/d/{id}` ‚Äî –ª—é–±–æ–π —á–µ–ª–æ–≤–µ–∫ –±–µ–∑ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è –≤–∏–¥–∏—Ç —Å–æ–±—Ä–∞–Ω–Ω—ã–π –ø–∞–∑–ª –∏ –º–æ–∂–µ—Ç —Å–∫–∞—á–∞—Ç—å. –ö–Ω–æ–ø–∫–∞ "Install TapX" –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ—Ç –ø—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞—é—â–∏—Ö –≤ –Ω–æ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è.

---

## API

### –ë–∞–∑–æ–≤—ã–π URL

```
https://api.tapx.io
```

CORS: —Å–µ—Ä–≤–µ—Ä –¥–æ–ª–∂–µ–Ω –ø—Ä–∏–Ω–∏–º–∞—Ç—å –∑–∞–ø—Ä–æ—Å—ã —Å –ª—é–±–æ–≥–æ Origin (—Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ –¥–µ–ª–∞–µ—Ç –∑–∞–ø—Ä–æ—Å –∏–∑ content script —Å Origin `chrome-extension://...` –∏–ª–∏ `moz-extension://...`):

```
Access-Control-Allow-Origin: *
Access-Control-Allow-Methods: POST, GET, OPTIONS
Access-Control-Allow-Headers: Content-Type
```

---

### POST /api/upload

–ü—Ä–∏–Ω–∏–º–∞–µ—Ç —Å–æ–±—Ä–∞–Ω–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ —Ç–≤–∏—Ç–∞ –æ—Ç —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è.

**Request:**

```
POST https://api.tapx.io/api/upload
Content-Type: multipart/form-data
```

| –ü–æ–ª–µ | –¢–∏–ø | –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ | –û–ø–∏—Å–∞–Ω–∏–µ |
|---|---|---|---|
| `image` | Blob (JPEG) | ‚úÖ | –°–∫–ª–µ–µ–Ω–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ, `image/jpeg` |
| `username` | string | ‚úÖ | @username –±–µ–∑ @, 1‚Äì50 —Å–∏–º–≤–æ–ª–æ–≤ |
| `tweetId` | string | ‚úÖ | –ß–∏—Å–ª–æ–≤–æ–π ID —Ç–≤–∏—Ç–∞ |
| `tweetUrl` | string | ‚úÖ | `https://x.com/username/status/id` |
| `tweetText` | string | ‚ùå | –¢–µ–∫—Å—Ç —Ç–≤–∏—Ç–∞, –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—É—Å—Ç—ã–º |
| `avatar` | Blob (JPEG/PNG) | ‚ùå | –ê–≤–∞—Ç–∞—Ä–∫–∞ –∞–≤—Ç–æ—Ä–∞ —Ç–≤–∏—Ç–∞ |

**–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:**
- –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä `image`: 50 MB
- –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä `avatar`: 2 MB
- –î–æ–ø—É—Å—Ç–∏–º—ã–µ MIME –¥–ª—è `image`: `image/jpeg`, `image/png`
- Rate limit: 20 uploads / IP / —á–∞—Å (free)

**Response 200:**

```json
{
  "url": "https://tapx.io/d/v7kX2mNp4q",
  "id": "v7kX2mNp4q",
  "expires": "2026-03-25T00:00:00Z"
}
```

**Response 400 ‚Äî Bad Request:**

```json
{
  "error": "invalid_image",
  "message": "Image must be JPEG or PNG"
}
```

**Response 413 ‚Äî Payload Too Large:**

```json
{
  "error": "file_too_large",
  "message": "Image must be under 50 MB"
}
```

**Response 429 ‚Äî Rate Limited:**

```json
{
  "error": "rate_limited",
  "message": "Too many uploads. Try again in 60 minutes.",
  "retry_after": 3600
}
```

---

### GET /d/:id

HTML-—Å—Ç—Ä–∞–Ω–∏—Ü–∞ –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –ø–∞–∑–ª–∞. –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç SSR-HTML —Å Open Graph —Ç–µ–≥–∞–º–∏ –¥–ª—è —à–µ—Ä–∏–Ω–≥–∞.

**URL:** `https://tapx.io/d/v7kX2mNp4q`

**–ü–æ–≤–µ–¥–µ–Ω–∏–µ:**
- –ï—Å–ª–∏ –∑–∞–ø–∏—Å—å –Ω–∞–π–¥–µ–Ω–∞ –∏ –Ω–µ –∏—Å—Ç—ë–∫ —Å—Ä–æ–∫ ‚Üí —Ä–µ–Ω–¥–µ—Ä–∏—Ç —Å—Ç—Ä–∞–Ω–∏—Ü—É
- –ï—Å–ª–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞ –∏–ª–∏ –∏—Å—Ç—ë–∫ ‚Üí 404-—Å—Ç—Ä–∞–Ω–∏—Ü–∞ —Å –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ–º —Å–∫–∞—á–∞—Ç—å —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ
- User-Agent –±–æ—Ç–∞ (og:image, Twitter Card) ‚Üí –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ Open Graph —Ç–µ–≥–∏

**Open Graph —Ç–µ–≥–∏:**

```html
<meta property="og:title"    content="@username ‚Äî TapX puzzle">
<meta property="og:image"    content="https://cdn.tapx.io/uploads/v7kX2mNp4q.jpg">
<meta property="og:url"      content="https://tapx.io/d/v7kX2mNp4q">
<meta property="og:description" content="–°–æ–±—Ä–∞–Ω–Ω—ã–π –ø–∞–∑–ª ¬∑ —Å–∫–∞—á–∞–π –Ω–∞ tapx.io">
<meta name="twitter:card"    content="summary_large_image">
```

---

### GET /api/d/:id

JSON-–º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –¥–ª—è –∑–∞–ø–∏—Å–∏ (–¥–ª—è –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã—Ö –≤–∏–¥–∂–µ—Ç–æ–≤, –¥–ª—è —Å–∞–º–æ–≥–æ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞ –ø—Ä–∏ CSR).

**Response 200:**

```json
{
  "id": "v7kX2mNp4q",
  "username": "sydneysfiles",
  "tweetId": "2024731512248127596",
  "tweetUrl": "https://x.com/sydneysfiles/status/2024731512248127596",
  "tweetText": "–Ω–æ–≤–∞—è —Ä–∞–±–æ—Ç–∞ üß©",
  "imageUrl": "https://cdn.tapx.io/uploads/v7kX2mNp4q.jpg",
  "avatarUrl": "https://cdn.tapx.io/avatars/v7kX2mNp4q.jpg",
  "createdAt": "2026-02-23T14:30:00Z",
  "expires": "2026-03-25T00:00:00Z",
  "downloadCount": 42
}
```

**Response 404:**

```json
{
  "error": "not_found",
  "message": "This puzzle has expired or does not exist"
}
```

---

### GET /api/d/:id/download

–†–µ–¥–∏—Ä–µ–∫—Ç–∏—Ç –Ω–∞ –ø—Ä—è–º–æ–π URL —Ñ–∞–π–ª–∞ –∏–ª–∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ñ–∞–π–ª —Å –∑–∞–≥–æ–ª–æ–≤–∫–æ–º `Content-Disposition: attachment`.

**Response 302:** ‚Üí `https://cdn.tapx.io/uploads/v7kX2mNp4q.jpg`

–£–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç —Å—á—ë—Ç—á–∏–∫ `download_count` –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö.

---

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã `/d/:id`

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  TapX                               [Get TapX Extension] ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ                                                          ‚îÇ
‚îÇ             [–°–æ–±—Ä–∞–Ω–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ]                      ‚îÇ
‚îÇ           (—à–∏—Ä–∏–Ω–∞ 100%, max-width 900px)                 ‚îÇ
‚îÇ                                                          ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ  [Avatar] @username                 [View on X ‚Üó]        ‚îÇ
‚îÇ  "—Ç–µ–∫—Å—Ç —Ç–≤–∏—Ç–∞..."                                        ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ                                                          ‚îÇ
‚îÇ         [ ‚¨á  Download Image ]   ‚Üê –∫—Ä—É–ø–Ω–∞—è –∫–Ω–æ–ø–∫–∞        ‚îÇ
‚îÇ                                                          ‚îÇ
‚îÇ         Expires: 25 March 2026                           ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ                                                          ‚îÇ
‚îÇ  [–†–µ–∫–ª–∞–º–Ω—ã–π –±–ª–æ–∫ ‚Äî Google AdSense –∏–ª–∏ –ø—Ä—è–º–∞—è —Ä–µ–∫–ª–∞–º–∞]    ‚îÇ
‚îÇ                                                          ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ  Shared via TapX ¬∑ Privacy ¬∑ Terms ¬∑ tapx.io             ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## –ú–æ–¥–µ–ª—å –¥–∞–Ω–Ω—ã—Ö

### –¢–∞–±–ª–∏—Ü–∞ `uploads`

```sql
CREATE TABLE uploads (
  id             VARCHAR(12)   PRIMARY KEY,        -- nanoid, 10 —Å–∏–º–≤–æ–ª–æ–≤
  created_at     TIMESTAMPTZ   NOT NULL DEFAULT NOW(),
  expires_at     TIMESTAMPTZ   NOT NULL,            -- created_at + 30 –¥–Ω–µ–π
  username       VARCHAR(50)   NOT NULL,
  tweet_id       VARCHAR(25)   NOT NULL,
  tweet_url      VARCHAR(300)  NOT NULL,
  tweet_text     TEXT,
  image_key      VARCHAR(255)  NOT NULL,            -- –ø—É—Ç—å –≤ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ (R2/S3)
  image_size     INTEGER       NOT NULL,            -- –±–∞–π—Ç—ã
  avatar_key     VARCHAR(255),                      -- nullable
  download_count INTEGER       NOT NULL DEFAULT 0,
  ip_hash        VARCHAR(64)   NOT NULL,            -- SHA-256 –æ—Ç IP, –¥–ª—è rate limiting
);
```

### –¢–∞–±–ª–∏—Ü–∞ `rate_limits` (–∏–ª–∏ Redis / KV)

```sql
CREATE TABLE rate_limits (
  ip_hash    VARCHAR(64) PRIMARY KEY,
  count      INTEGER     NOT NULL DEFAULT 1,
  window_end TIMESTAMPTZ NOT NULL
);
```

---

## –§–∞–π–ª–æ–≤–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ

**–†–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–Ω—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã:**

| –í–∞—Ä–∏–∞–Ω—Ç | –ü–ª—é—Å—ã | –ú–∏–Ω—É—Å—ã |
|---|---|---|
| **Cloudflare R2** | –ë–µ—Å–ø–ª–∞—Ç–Ω–æ –¥–æ 10 GB/–º–µ—Å, –Ω–µ—Ç egress fees, –±—ã—Å—Ç—Ä–æ | Vendored |
| **AWS S3** | –°—Ç–∞–Ω–¥–∞—Ä—Ç –∏–Ω–¥—É—Å—Ç—Ä–∏–∏, –±–æ–≥–∞—Ç–∞—è —ç–∫–æ—Å–∏—Å—Ç–µ–º–∞ | –ü–ª–∞—Ç–Ω—ã–π egress |
| **DigitalOcean Spaces** | S3-compatible, –¥–µ—à–µ–≤–ª–µ S3 | –ú–µ–Ω—å—à–µ —Ä–µ–≥–∏–æ–Ω–æ–≤ |

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–ª—é—á–µ–π –≤ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ:**

```
uploads/{id}.jpg        ‚Äî –æ—Å–Ω–æ–≤–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
avatars/{id}.jpg        ‚Äî –∞–≤–∞—Ç–∞—Ä–∫–∞ (–µ—Å–ª–∏ –±—ã–ª–∞ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞)
```

**CDN:** Cloudflare (–ø–µ—Ä–µ–¥ R2) –∏–ª–∏ CloudFront (–ø–µ—Ä–µ–¥ S3) ‚Äî –¥–ª—è –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è –∏ —Å–Ω–∏–∂–µ–Ω–∏—è –Ω–∞–≥—Ä—É–∑–∫–∏.

---

## –ü–æ–ª–∏—Ç–∏–∫–∞ –∏—Å—Ç–µ—á–µ–Ω–∏—è —Å—Ä–æ–∫–∞ (TTL)

–°—Ä–æ–∫ —Ö—Ä–∞–Ω–µ–Ω–∏—è: **30 –¥–Ω–µ–π** –¥–ª—è –≤—Å–µ—Ö –∑–∞–≥—Ä—É–∑–æ–∫.

Cron-–∑–∞–¥–∞—á–∞ —Ä–∞–∑ –≤ —Å—É—Ç–∫–∏ —É–¥–∞–ª—è–µ—Ç –∏—Å—Ç—ë–∫—à–∏–µ –∑–∞–ø–∏—Å–∏ –∏–∑ –ë–î –∏ —Ñ–∞–π–ª—ã –∏–∑ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞.

---

## –ú–æ–Ω–µ—Ç–∏–∑–∞—Ü–∏—è

### –†–µ–∫–ª–∞–º–∞ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ `/d/:id`

- **Google AdSense** –∏–ª–∏ –ø—Ä—è–º–∞—è —Ä–µ–∫–ª–∞–º–∞
- –î–≤–∞ –±–ª–æ–∫–∞: –æ–¥–∏–Ω –º–µ–∂–¥—É –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º –∏ –∫–Ω–æ–ø–∫–æ–π Download, –æ–¥–∏–Ω –≤ —Ñ—É—Ç–µ—Ä–µ
- –í—Å–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –≤–∏–¥—è—Ç —Ä–µ–∫–ª–∞–º—É ‚Äî –±–µ–∑ –∏—Å–∫–ª—é—á–µ–Ω–∏–π –∏ –ø–ª–∞—Ç–Ω—ã—Ö —Ç–∞—Ä–∏—Ñ–æ–≤

### –í–∏—Ä—É—Å–Ω—ã–π —Ä–æ—Å—Ç

–ö–∞–∂–¥–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ `/d/:id` —Å–æ–¥–µ—Ä–∂–∏—Ç –∫–Ω–æ–ø–∫—É **"Get TapX Extension"** ‚Üí —Å—Å—ã–ª–∫–∞ –Ω–∞ Chrome Web Store / AMO.
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏, –ø–æ–ª—É—á–∏–≤—à–∏–µ —Å—Å—ã–ª–∫—É –æ—Ç –¥—Ä—É–≥–∞, –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É—é—Ç—Å—è –≤ –Ω–æ–≤—ã–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è.

---

## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫ (—Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏)

| –°–ª–æ–π | –í–∞—Ä–∏–∞–Ω—Ç—ã |
|---|---|
| **Runtime** | Bun / Node.js |
| **Framework** | Hono (–ª–µ–≥–∫–æ–≤–µ—Å–Ω—ã–π, —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ Cloudflare Workers) / Fastify / Express |
| **–ë–î** | PostgreSQL (Neon / Supabase) –∏–ª–∏ Turso (libSQL, serverless) |
| **–•—Ä–∞–Ω–∏–ª–∏—â–µ** | Cloudflare R2 |
| **CDN/Deploy** | Cloudflare Workers + Pages |
| **Frontend** | –ü—Ä–æ—Å—Ç–æ–π SSR (Hono JSX) –∏–ª–∏ Next.js / SvelteKit |
| **Rate Limiting** | Cloudflare KV –∏–ª–∏ Redis |

**MVP-–ø—É—Ç—å —Å –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π:**
Cloudflare Workers (API) + Cloudflare R2 (—Ñ–∞–π–ª—ã) + Turso (–ë–î) = –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏ $0/–º–µ—Å –¥–æ 10k –∑–∞–≥—Ä—É–∑–æ–∫.

---

## –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ–º

### –ß—Ç–æ –æ–∂–∏–¥–∞–µ—Ç —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ –æ—Ç API

1. **POST /api/upload** –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `{ url, expires }` ‚Üí —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç `url` –≤ –Ω–æ–≤–æ–π –≤–∫–ª–∞–¥–∫–µ
2. –û—Ç–≤–µ—Ç –ø—Ä–∏—Ö–æ–¥–∏—Ç –≤ —Ç–µ—á–µ–Ω–∏–µ 5‚Äì10 —Å–µ–∫—É–Ω–¥ (–Ω–∞ –≤—Ä–µ–º—è upload –∫–Ω–æ–ø–∫–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç spinner)
3. –ü—Ä–∏ –æ—à–∏–±–∫–µ (400, 413, 429, 500) —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é

### –ß—Ç–æ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç (–≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ)

- `image` ‚Äî –≤—Å–µ–≥–¥–∞ JPEG, –∫–∞—á–µ—Å—Ç–≤–æ 0.92, —Å–∫–ª–µ–µ–Ω —á–µ—Ä–µ–∑ Canvas API –∏–∑ –æ—Ä–∏–≥–∏–Ω–∞–ª–æ–≤ `name=orig`
- `username` ‚Äî —Å—Ç—Ä–æ–∫–∞ 1‚Äì50 —Å–∏–º–≤–æ–ª–æ–≤, —Ç–æ–ª—å–∫–æ `[A-Za-z0-9_]`, –∏–ª–∏ —Å—Ç—Ä–æ–∫–∞ `"unknown"`
- `tweetId` ‚Äî —Å—Ç—Ä–æ–∫–∞ —Ü–∏—Ñ—Ä, –∏–ª–∏ timestamp –≤ –º—Å (fallback)
- `tweetUrl` ‚Äî –≤—Å–µ–≥–¥–∞ `https://x.com/...`
- `tweetText` ‚Äî –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—É—Å—Ç–æ–π —Å—Ç—Ä–æ–∫–æ–π
- `avatar` ‚Äî –º–æ–∂–µ—Ç –æ—Ç—Å—É—Ç—Å—Ç–≤–æ–≤–∞—Ç—å (–µ—Å–ª–∏ fetch –Ω–µ —É–¥–∞–ª—Å—è)

### –ü–æ–ª–µ `tweetId = "unknown"` –∏–ª–∏ timestamp

–ï—Å–ª–∏ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ –Ω–µ —Å–º–æ–≥–ª–æ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å ID —Ç–≤–∏—Ç–∞ ‚Äî —Å–µ—Ä–≤–µ—Ä –¥–æ–ª–∂–µ–Ω –ø—Ä–∏–Ω—è—Ç—å –∑–∞–ø–∏—Å—å, —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–≤ —Å–≤–æ–π ID. –ù–µ –Ω—É–∂–Ω–æ –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å –æ—à–∏–±–∫—É.

---

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

| –£–≥—Ä–æ–∑–∞ | –ú–µ—Ä–∞ –∑–∞—â–∏—Ç—ã |
|---|---|
| Spam / abuse upload | Rate limiting –ø–æ IP (20/—á–∞—Å) + honeypot |
| –•—Ä–∞–Ω–µ–Ω–∏–µ –≥–∏–≥–∞–Ω—Ç—Å–∫–∏—Ö —Ñ–∞–π–ª–æ–≤ | –õ–∏–º–∏—Ç 50 MB + –ø—Ä–æ–≤–µ—Ä–∫–∞ MIME |
| NSFW / copyright | DMCA endpoint –¥–ª—è –∂–∞–ª–æ–± (`/dmca`) |
| PII –≤ —Ç–µ–∫—Å—Ç–µ —Ç–≤–∏—Ç–∞ | –¢–µ–∫—Å—Ç —Ö—Ä–∞–Ω–∏—Ç—Å—è "–∫–∞–∫ –µ—Å—Ç—å", –Ω–µ –∏–Ω–¥–µ–∫—Å–∏—Ä—É–µ—Ç—Å—è –ø–æ–∏—Å–∫–æ–≤–∏–∫–∞–º–∏ (`noindex`) |
| CORS bypass | –ü—Ä–æ–≤–µ—Ä–∫–∞ Content-Type, –≤–∞–ª–∏–¥–∞—Ü–∏—è –ø–æ–ª–µ–π |

**SEO:** –≤—Å–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã `/d/:id` ‚Äî `<meta name="robots" content="noindex">`. –°–∞–π—Ç –Ω–µ –¥–æ–ª–∂–µ–Ω –∏–Ω–¥–µ–∫—Å–∏—Ä–æ–≤–∞—Ç—å—Å—è ‚Äî —ç—Ç–æ –Ω–µ –º–µ–¥–∏–∞-–∞—Ä—Ö–∏–≤, –∞ —É—Ç–∏–ª–∏—Ç–∞ –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è.

---

## Endpoints Summary

| –ú–µ—Ç–æ–¥ | URL | –û–ø–∏—Å–∞–Ω–∏–µ |
|---|---|---|
| `POST` | `/api/upload` | –ó–∞–≥—Ä—É–∑–∫–∞ –æ—Ç —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è |
| `GET` | `/d/:id` | HTML-—Å—Ç—Ä–∞–Ω–∏—Ü–∞ –ø–∞–∑–ª–∞ |
| `GET` | `/api/d/:id` | JSON-–º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ |
| `GET` | `/api/d/:id/download` | –†–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ —Ñ–∞–π–ª + —Å—á—ë—Ç—á–∏–∫ |
| `POST` | `/dmca` | –ñ–∞–ª–æ–±–∞ –Ω–∞ –∫–æ–Ω—Ç–µ–Ω—Ç |
| `GET` | `/health` | Healthcheck –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ |
